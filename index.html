<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Sensori</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
    }

    h1 {
      margin-bottom: 20px;
      color: var(--accent-color);
      transition: color 0.3s;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(460px, 1fr));
      gap: 20px;
      width: 100%;
      max-width: 960px;
    }

    .card {
      background-color: var(--card-bg);
      border: 2px solid var(--card-border);
      border-radius: 10px;
      box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 10px;
      transition: background-color 0.3s, border-color 0.3s;
    }

    iframe {
      border: none;
      border-radius: 8px;
    }

    .theme-toggle {
      position: absolute;
      top: 15px;
      right: 15px;
      padding: 8px 12px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 18px;
      background-color: var(--card-bg);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
    }
  </style>
</head>
<body>
  <button class="theme-toggle" onclick="toggleTheme()">??</button>
  <h1>Dashboard Sensori</h1>
  <div class="grid">
    <!-- Grafico 1 -->
    <div class="card">
      <iframe id="chart1" width="450" height="260"></iframe>
    </div>

    <!-- Widget 1 -->
    <div class="card">
      <iframe id="widget1" width="450" height="260"></iframe>
    </div>
    
    <!-- Grafico 2 -->
    <div class="card">
      <iframe id="chart2" width="450" height="260"></iframe>
    </div>
    
    <!-- Widget 2 -->
    <div class="card">
      <iframe id="widget2" width="450" height="260"></iframe>
    </div>
    
    <!-- Grafico 3 -->
    <div class="card">
      <iframe id="chart3" width="450" height="260"></iframe>
    </div>

    <!-- Widget 3 -->
    <div class="card">
      <iframe id="widget3" width="450" height="260"></iframe>
    </div>
  </div>

  <script>
    // Definizione temi
    const themes = {
      dark: {
        "--bg-color": "#121212",
        "--text-color": "#f0f0f0",
        "--card-bg": "#2b2b2b",
        "--card-border": "#333",
        "--accent-color": "#ff4c4c",
        chartBg: "%232b2b2b",
        chartColor: "%23ff4c4c",
        gridColor: "%23aaaaaa",
        labelColor: "%23ffffff"
      },
      light: {
        "--bg-color": "#f5f5f5",
        "--text-color": "#1a1a1a",
        "--card-bg": "#ffffff",
        "--card-border": "#cccccc",
        "--accent-color": "#d62020",
        chartBg: "%23ffffff",
        chartColor: "%23d62020",
        gridColor: "%23999999",
        labelColor: "%23000000"
      }
    };

    let currentTheme = "dark";

    function applyTheme(theme) {
      const root = document.documentElement;
      const properties = themes[theme];
      for (let key in properties) {
        if (key.startsWith("--")) {
          root.style.setProperty(key, properties[key]);
        }
      }

      // Aggiorna il bottone
      document.querySelector(".theme-toggle").textContent = theme === "dark" ? "Dark" : "Light";

      // Aggiorna i grafici con colori coerenti
      document.getElementById("chart1").src =
        `https://thingspeak.com/channels/3067311/charts/1?bgcolor=${properties.chartBg}&color=${properties.chartColor}&dynamic=true&results=50&type=line&update=15&gridcolor=${properties.gridColor}&labelcolor=${properties.labelColor}`;

      document.getElementById("chart2").src =
        `https://thingspeak.com/channels/3067311/charts/2?bgcolor=${properties.chartBg}&color=${properties.chartColor}&dynamic=true&results=50&type=line&update=15&gridcolor=${properties.gridColor}&labelcolor=${properties.labelColor}`;

      document.getElementById("chart3").src =
        `https://thingspeak.com/channels/3067311/charts/3?bgcolor=${properties.chartBg}&color=${properties.chartColor}&dynamic=true&results=6000&type=line&update=15&gridcolor=${properties.gridColor}&labelcolor=${properties.labelColor}`;

      // Aggiorna i widget (supporto limitato)
      document.getElementById("widget1").src =
        `https://thingspeak.com/channels/3067311/widgets/1130559?bgcolor=${properties.chartBg}`;
      document.getElementById("widget2").src =
        `https://thingspeak.com/channels/3067311/widgets/1130564?bgcolor=${properties.chartBg}`;
      document.getElementById("widget3").src =
        `https://thingspeak.com/channels/3067311/widgets/1131551?bgcolor=${properties.chartBg}`;        
    }

    function toggleTheme() {
      currentTheme = currentTheme === "dark" ? "light" : "dark";
      applyTheme(currentTheme);
    }

    // Imposta tema iniziale
    applyTheme(currentTheme);
  </script>
</body>
</html>

